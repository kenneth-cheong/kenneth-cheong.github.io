<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Team Query</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>SEO Team Assistance Request</h1>
    <button onclick="sendRequest()">Send Query</button>
    <p id="responseText">Response will appear here after sending the query.</p>

    <script>
        function sendRequest() {
            const responseText = document.getElementById('responseText');

            // Read the base64 content from a local .txt file
            fetch('base64.txt')
                .then(response => response.text())
                .then(base64Content => {
                    const question = "Can your SEO team help to reduce the server response time of my website??";
                    const url = "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=AIzaSyAkYBqT7uSa7BfbeKrbxTFrfHeU9oF34";

                    // Prepare the request payload
                    const querystring = {
                        "contents": [{
                            "parts": [{
                                    "text": "Based on the attached csv, answer the following question concisely. If the csv does not contain the answer, try to answer it using external knowledge. If you do not know the answer, reply 'I don't know the answer, please drop us an email on your query!': " + question
                                },
                                {
                                    "inlineData": {
                                        "mimeType": "text/csv",
                                        "data": base64Content.trim() // Ensure no extra whitespace
                                    }
                                }
                            ],
                            "role": "user"
                        }]
                    };

                    const headers = {
                        "Accept": "application/json",
                        "Content-Type": "application/json"
                    };

                    // Make the API request using axios
                    axios.post(url, querystring, { headers })
                        .then(response => {
                            responseText.textContent = response.data['candidates'][0]['content']['parts'][0]['text'];
                        })
                        .catch(error => {
                            console.error('API call failed:', error);
                            responseText.textContent = 'Failed to get a response from the API.';
                        });
                })
                .catch(error => {
                    console.error('Failed to read the base64 content:', error);
                    responseText.textContent = 'Failed to read the base64 content.';
                });
        }
    </script>
</body>
</html>