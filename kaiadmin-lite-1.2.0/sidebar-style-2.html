<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Digimetrics - New Look</title>
  <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport" />
  <link rel="icon"
    href="https://mediaonemarketing.com.sg/wp-content/uploads/2023/11/cropped-MediaOne-M-favicon-logo-32x32.png"
    type="image/x-icon" />

  <!-- Fonts and icons -->
  <script src="assets/js/plugin/webfont/webfont.min.js"></script>
  <script>
    WebFont.load({
      google: { families: ["Public Sans:300,400,500,600,700"] },
      custom: {
        families: [
          "Font Awesome 5 Solid",
          "Font Awesome 5 Regular",
          "Font Awesome 5 Brands",
          "simple-line-icons",
        ],
        urls: ["assets/css/fonts.min.css"],
      },
      active: function () {
        sessionStorage.fonts = true;
      },
    });
  </script>

  <!-- CSS Files -->
  <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/plugins.min.css" />
  <link rel="stylesheet" href="assets/css/kaiadmin.min.css" />


  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link rel="stylesheet" href="assets/css/demo.css" />
</head>

<body>
  <div class="wrapper">
    <!-- Sidebar -->
    <div class="sidebar sidebar-style-2" data-background-color="dark">
      <div class="sidebar-logo">
        <!-- Logo Header -->
        <div class="logo-header" data-background-color="dark">
          <a href="#" class="logo">
            <img src="assets/img/kaiadmin/Digimetrics Logo-02.png" alt="navbar brand" class="navbar-brand"
              height="20" />
          </a>
          <div class="nav-toggle">
            <button class="btn btn-toggle toggle-sidebar">
              <i class="gg-menu-right"></i>
            </button>
            <button class="btn btn-toggle sidenav-toggler">
              <i class="gg-menu-left"></i>
            </button>
          </div>
          <button class="topbar-toggler more">
            <i class="gg-more-vertical-alt"></i>
          </button>
        </div>
        <!-- End Logo Header -->
      </div>
      <div class="sidebar-wrapper scrollbar scrollbar-inner">
        <div class="sidebar-content">
          <ul class="nav nav-secondary">
            <li class="nav-item">
              <a data-bs-toggle="collapse" href="#dashboard" class="collapsed" aria-expanded="false">
                <i class="fas fa-home"></i>
                <p>Dashboard</p>
                <span class="caret"></span>
              </a>
              <div class="collapse" id="dashboard">
                <ul class="nav nav-collapse">
                  <li>
                    <a href="">
                      <span class="sub-item">Dashboard 1</span>
                    </a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="nav-section">
              <span class="sidebar-mini-icon">
                <i class="fa fa-ellipsis-h"></i>
              </span>
              <h4 class="text-section">Components</h4>
            </li>
            <li class="nav-item">
              <a data-bs-toggle="collapse" href="#base">
                <i class="fas fa-layer-group"></i>
                <p>SEO</p>
                <span class="caret"></span>
              </a>
              <div class="collapse" id="base">
                <ul class="nav nav-collapse">
                  <li>
                    <a href="">
                      <span class="sub-item">Keyword Analysis</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">Google Crawler Simulator</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">Website Technical Audit</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">Content Comparison</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">On-Page Recommendations</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">Rank Checker</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">Schema Generator</span>
                    </a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="nav-item">
              <a data-bs-toggle="collapse" href="#maps">
                <i class="fas fa-audio-description"></i>
                <p>SEM</p>
                <span class="caret"></span>
              </a>
              <div class="collapse" id="maps">
                <ul class="nav nav-collapse">
                  <li>
                    <a href="">
                      <span class="sub-item">Landing Page Audit</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">Competitors' Ads</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">Ads Generator</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">Ads Research</span>
                    </a>
                  </li>
                </ul>
              </div>
            </li>
            <li class="nav-item">
              <a data-bs-toggle="collapse" href="#charts">
                <i class="fas fa-podcast"></i>
                <p>Social Media</p>
                <span class="caret"></span>
              </a>
              <div class="collapse" id="charts">
                <ul class="nav nav-collapse">
                  <li>
                    <a href="">
                      <span class="sub-item">Persona Generator</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">Copy Generator</span>
                    </a>
                  </li>
                  <li>
                    <a href="">
                      <span class="sub-item">Content Checker</span>
                    </a>
                  </li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <!-- End Sidebar -->

    <div class="main-panel">
      <div class="main-header">
        <div class="main-header-logo">
          <!-- Logo Header -->
          <div class="logo-header" data-background-color="dark">
            <a href="index.html" class="logo">
              <img src="assets/img/kaiadmin/logo_light.svg" alt="navbar brand" class="navbar-brand" height="20" />
            </a>
            <div class="nav-toggle">
              <button class="btn btn-toggle toggle-sidebar">
                <i class="gg-menu-right"></i>
              </button>
              <button class="btn btn-toggle sidenav-toggler">
                <i class="gg-menu-left"></i>
              </button>
            </div>
            <button class="topbar-toggler more">
              <i class="gg-more-vertical-alt"></i>
            </button>
          </div>
          <!-- End Logo Header -->
        </div>
        <!-- Navbar Header -->
        <nav class="navbar navbar-header navbar-header-transparent navbar-expand-lg border-bottom">
          <div class="container-fluid">

            <div class="collapse navbar-collapse" id="navbarNav">
              <div>
                <div style="margin: 10px" id="seoRow">
                  <ul class="breadcrumbs mb-3">
                    <li class="nav-item">
                      <a href="#"> SEO</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#" style="font-weight:1000;"> Keyword Analysis</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"><i class="fas fa-check-circle" style="color: green; margin-right: 5px;"
                          aria-hidden="true"></i> Rank Checker</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"><i class="fas fa-check-circle" style="color: green; margin-right: 5px;"
                          aria-hidden="true"></i> Content Comparison</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> On-Page Recommendations</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Schema Generator</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Technical Audit</a>
                    </li>
                  </ul>
                </div>
                <div style="margin: 10px" id="semRow">
                  <ul class="breadcrumbs mb-3">
                    <li class="nav-item">
                      <a href="#"> SEM</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Landing Page Audit</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Competitors' Ads</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Ads Research</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Ads Generator</a>
                    </li>
                  </ul>
                </div>
                <div style="margin: 10px" id="smmRow">
                  <ul class="breadcrumbs mb-3">
                    <li class="nav-item">
                      <a href="#"> Social Media</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Persona Generator</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Content Generator</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Content Checker</a>
                    </li>
                  </ul>
                </div>
                <div style="margin: 10px" id="bdRow">
                  <ul class="breadcrumbs mb-3">
                    <li class="nav-item">
                      <a href="#"> BD</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Competitors Identifier</a>
                    </li>
                    <li class="separator">
                      <i class="icon-arrow-right"></i>
                    </li>
                    <li class="nav-item">
                      <a href="#"> Media Plan</a>
                    </li>
                  </ul>
                </div>
              </div>
              <!-- Collapse Button -->
            </div>
            <button class="navbar-toggler" style="display:block;" type="button" onclick="toggleRows()">
              <span class="navbar-toggler-icon"></span>
            </button>
          </div>
        </nav>
        <!-- End Navbar -->
      </div>
      <script>
        let rowsHidden = false; // Keep track of the state

        function toggleRows() {
          const semRow = document.getElementById('semRow');
          const smmRow = document.getElementById('smmRow');
          const bdRow = document.getElementById('bdRow');

          if (rowsHidden) {
            // Show the rows
            semRow.style.display = "block";
            smmRow.style.display = "block";
            bdRow.style.display = "block";
            rowsHidden = false;
          } else {
            // Hide the rows
            semRow.style.display = "none";
            smmRow.style.display = "none";
            bdRow.style.display = "none";
            rowsHidden = true;
          }
        }
      </script>

      <script>

        document.addEventListener('DOMContentLoaded', function () {
          toggleRows();
          const textarea = document.getElementById('keyword_analysis_keywords');
          if (textarea) {
            textarea.addEventListener('input', updateKeywordCount);
            updateKeywordCount(); // Initial count
          } else {
            console.warn('Textarea with ID "keyword_analysis_keywords" not found.');
          }
        });

        function clearKeywordAnalysis() {

        }

        async function serpModal(keyword) {
          const country = document.getElementById('keywordAnalysisCountry').value;
          const language = document.getElementById('keywordAnalysisLanguage').value;
          //user = JSON.parse(localStorage.getItem('googleUser')).email;
          const response = await fetch('https://8k6r15rg4m.execute-api.ap-southeast-1.amazonaws.com/serpLite', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ keyword, language, location: country }),
          });
          const serpData = await response.json();

          console.log(serpData);
          document.getElementById('serpHeader').textContent = 'SERP for ' + keyword;

          populateSerpTable(serpData.body);
        }

        function populateSerpTable(keywords) {
          const tableBody = document.querySelector("#serpTable tbody");

          //Clear existing table rows
          tableBody.innerHTML = "";

          const serpArray = Object.entries(keywords).map(([rank, data]) => ({
            rank: rank,
            url: data.url,
            title: data.title,
            description: data.description
          }));

          //Iterate through the keywords and create table rows
          serpArray.forEach(rank => {
            const row = tableBody.insertRow();
            const rankCell = row.insertCell();
            const urlCell = row.insertCell();
            const titleCell = row.insertCell();
            const descriptionCell = row.insertCell();

            rankCell.textContent = rank.rank;
            urlCell.textContent = rank.url;
            titleCell.textContent = rank.title;
            descriptionCell.textContent = rank.description;
          });

          makeTableSortable('serpTable');
          document.getElementById('serpCard').style.display = "block";
        }

        async function keywordAnalysis() {
          document.getElementById('keywordAnalysisUrlHelp').style.display = "none";
          document.getElementById('keywordAnalysisKeywordsHelp').style.display = "none";
          document.getElementById('keywordAnalysisUrlDiv').classList.remove('has-error', 'has-feedback');
          document.getElementById('keywordAnalysisKeywordsDiv').classList.remove('has-error', 'has-feedback');

          if (!document.getElementById('keyword_analysis_url').value && !document.getElementById('keyword_analysis_keywords').value) {
            document.getElementById('keywordAnalysisUrlHelp').style.display = "block";
            document.getElementById('keywordAnalysisUrlDiv').classList.add('has-error', 'has-feedback');
            document.getElementById('keywordAnalysisKeywordsHelp').style.display = "block";
            document.getElementById('keywordAnalysisKeywordsDiv').classList.add('has-error', 'has-feedback');
          } else {
            document.getElementById('keywordAnalysisSubmit').innerHTML = '<div class="custom-toggle rotate"><i class="icon-settings"></i></div>';
            document.querySelector("#serpTable tbody").innerHTML = "";

            const urlValue = document.getElementById('keyword_analysis_url').value;
            const keywordsValue = document.getElementById('keyword_analysis_keywords').value;

            const promises = [];

            if (urlValue != "") {
              promises.push(getRankingKeywords());
              promises.push(getWebpageKeywords());
            }

            if (keywordsValue != "") {
              promises.push(getSimilarKeywords());
            }

            try {
              await Promise.all(promises);
            } catch (error) {
              console.error("One or more keyword analysis tasks failed:", error);
            } finally {
              document.getElementById('keywordAnalysisSubmit').innerHTML = 'Submit';
            }

          }
        }

        async function getSimilarKeywords() {
          document.getElementById('similarKeywordsCard').style.display = "none";
          const country = document.getElementById('keywordAnalysisCountry').value;
          const language = document.getElementById('keywordAnalysisLanguage').value;
          const keywords = document.getElementById('keyword_analysis_keywords').value.split(/[\n,]+/).map(k => k.trim()).filter(Boolean);
          document.getElementById('similarKeywordsHeader').textContent = "Similar Keywords";


          var url = "https://lgvdhcs4t2.execute-api.ap-southeast-1.amazonaws.com/similarKeywords";
          var queryString = {
            "keywords": keywords,
            "location": country,
            "language": language
            ,//"user": JSON.parse(localStorage.getItem('googleUser')).email
          };

          var headers = {
            "Content-Type": "application/json",
          };

          try {
            const response = await fetch(url, {
              method: 'POST',
              headers: headers,
              body: JSON.stringify(queryString)
            });

            if (!response.ok) {
              throw new Error(`HTTP error! Status: ${response.status}`);
            }
            const data = await response.json();
            populateSimilarKeywordsTable(data.body);
          } catch (error) {
            console.error("Error fetching data:", error);
            // Re-throw the error to signal failure to the caller (keywordAnalysis)
            throw error;
          }


        }

        async function getRankingKeywords() {
          document.getElementById('rankedKeywordsCard').style.display = "none";
          const domain = document.getElementById('keyword_analysis_url').value;
          const country = document.getElementById('keywordAnalysisCountry').value;
          document.getElementById('rankingKeywordsHeader').textContent = "Ranked Keywords";

          let targetDomain = domain;

          if (document.getElementById('keywordAnalysisTypeDomain').checked) {
            if (targetDomain.includes('http')) {
              targetDomain = (targetDomain.replace('http://', '').replace('https://')).split('/')[0];
            }
          } else {
            if (!targetDomain.includes('http')) {
              targetDomain = 'https://' + targetDomain;
            }
          }

          const url = "https://0dqny7l5y9.execute-api.ap-southeast-1.amazonaws.com/rankingKeywords";

          const headers = {
            "Content-Type": "application/json",
          };

          const queryString = {
            "target": targetDomain,
            "location": country
          };

          try {
            const response = await fetch(url, {
              method: 'POST',
              headers: headers,
              body: JSON.stringify(queryString)
            });

            if (!response.ok) {
              throw new Error(`HTTP error! Status: ${response.status}`);
            }
            const data = await response.json();
            populateRankingKeywordsTable(data.body);
            addTableEventListeners();
          } catch (error) {
            console.error("Error fetching data:", error);
            // Re-throw the error to signal failure to the caller (keywordAnalysis)
            throw error;
          }
        }

        async function getWebpageKeywords() {
          document.getElementById('webpageKeywordsCard').style.display = "none";
          const domain = document.getElementById('keyword_analysis_url').value;
          const country = document.getElementById('keywordAnalysisCountry').value;
          const language = document.getElementById('keywordAnalysisLanguage').value;
          document.getElementById('rankingKeywordsHeader').textContent = "Ranked Keywords";

          const endpoint = "https://ei6xj9x2rd.execute-api.ap-southeast-1.amazonaws.com/keywordsForSite";
          try {
            const response = await fetch(endpoint, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                location: country,
                language: language,
                target: domain
              })
            });

            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            if (typeof data !== 'object' || data === null) {
              console.error("Data is not an object:", data);
              return; // Exit function if data is not an object.
            }
            const allKeywords = Object.entries(data).map(([keyword, values]) => ({
              keyword,
              search_volume: values.search_volume,
              competition: values.competition,
              search_intent: values.search_intent,
              reason_for_choosing: values.reason_for_choosing
            }));

            populateWebpageKeywordsTable(allKeywords);
          } catch (error) {
            console.error("Error fetching data:", error);
            // Re-throw the error to signal failure to the caller (keywordAnalysis)
            throw error;
          }
        }

        function populateWebpageKeywordsTable(keywords) {
          const tableBody = document.querySelector("#webpageKeywordsTable tbody");

          //Clear existing table rows
          tableBody.innerHTML = "";

          //Iterate through the keywords and create table rows
          keywords.forEach(keyword => {
            const row = tableBody.insertRow();
            const keywordCell = row.insertCell();
            const searchVolCell = row.insertCell();
            const competitionCell = row.insertCell();
            const searchIntentCell = row.insertCell();
            const reasonCell = row.insertCell();
            const addCell = row.insertCell();

            keywordCell.textContent = keyword.keyword;
            searchVolCell.textContent = keyword.search_volume;
            competitionCell.textContent = keyword.competition;
            searchIntentCell.textContent = keyword.search_intent;
            reasonCell.textContent = keyword.reason_for_choosing;

            // Create the + icon with a class for styling and a click handler
            const plusIcon = document.createElement("i");
            plusIcon.classList.add("fas", "fa-plus-circle", "clickable-plus");
            plusIcon.addEventListener("click", () => {
              addKeywordToTextarea(keyword.keyword);
              addCell.textContent = "added";
            });
            addCell.appendChild(plusIcon);
          });
          makeTableSortable('webpageKeywordsTable');
          document.getElementById('webpageKeywordsHeader').textContent += ' (' + String(keywords.length) + ')';
          document.getElementById('webpageKeywordsCard').style.display = "block";
        }

        function populateSimilarKeywordsTable(keywords) {
          const tableBody = document.querySelector("#similarKeywordsTable tbody");

          //Clear existing table rows
          tableBody.innerHTML = "";

          const similarKeywordsArray = Object.entries(keywords).map(([keyword, data]) => ({
            keyword: keyword,
            search_volume: data.search_volume,
            cpc: data.cpc,
            competition: data.competition
          }));

          //Iterate through the keywords and create table rows
          similarKeywordsArray.forEach(keyword => {
            const row = tableBody.insertRow();
            const keywordCell = row.insertCell();
            const searchVolCell = row.insertCell();
            const competitionCell = row.insertCell();
            const cpcCell = row.insertCell();
            const addCell = row.insertCell();

            keywordCell.textContent = keyword.keyword;
            searchVolCell.textContent = keyword.search_volume;
            competitionCell.textContent = keyword.competition;
            cpcCell.textContent = keyword.cpc;

            // Create the + icon with a class for styling and a click handler
            const plusIcon = document.createElement("i");
            plusIcon.classList.add("fas", "fa-plus-circle", "clickable-plus");
            plusIcon.addEventListener("click", () => {
              addKeywordToTextarea(keyword.keyword);
              addCell.textContent = "added";
            });
            addCell.appendChild(plusIcon);
          });
          makeTableSortable('similarKeywordsTable');
          document.getElementById('similarKeywordsHeader').textContent += ' (' + String(similarKeywordsArray.length) + ')';
          document.getElementById('similarKeywordsCard').style.display = "block";
        }

        function populateRankingKeywordsTable(keywords) {
          const tableBody = document.querySelector("#rankingKeywordsTable tbody");

          //Clear existing table rows
          tableBody.innerHTML = "";

          const rankedKeywordsArray = Object.entries(keywords).map(([keyword, data]) => ({
            keyword: keyword,
            search_volume: data.search_volume,
            rank: data.rank,
            difficulty: data.difficulty
          }));

          //Iterate through the keywords and create table rows
          rankedKeywordsArray.forEach(keyword => {
            const row = tableBody.insertRow();
            const keywordCell = row.insertCell();
            const searchVolCell = row.insertCell();
            const rankCell = row.insertCell();
            const cpcCell = row.insertCell();
            const addCell = row.insertCell();

            keywordCell.textContent = keyword.keyword;
            searchVolCell.textContent = keyword.search_volume;
            rankCell.textContent = keyword.rank;
            cpcCell.textContent = keyword.cpc;

            // Create the + icon with a class for styling and a click handler
            const plusIcon = document.createElement("i");
            plusIcon.classList.add("fas", "fa-plus-circle", "clickable-plus");
            plusIcon.addEventListener("click", () => {
              addKeywordToTextarea(keyword.keyword);
              addCell.textContent = "added";
            });
            addCell.appendChild(plusIcon);
          });
          makeTableSortable('rankingKeywordsTable');
          document.getElementById('rankingKeywordsHeader').textContent += ' (' + String(rankedKeywordsArray.length) + ')';
          document.getElementById('rankedKeywordsCard').style.display = "block";
        }



        function addKeywordToTextarea(keyword) {
          const textarea = document.getElementById('keyword_analysis_keywords');
          const existingKeywords = textarea.value.split(/[\n,]+/).map(k => k.trim()).filter(Boolean);

          if (!existingKeywords.includes(keyword)) {
            textarea.value += keyword + "\n";
            updateKeywordCount();
          } else {
            console.log(`Keyword "${keyword}" already exists in textarea. Skipping.`);
          }
        }

        function updateKeywordCount() {
          const textarea = document.getElementById('keyword_analysis_keywords');
          const keywords = textarea.value.split(/[\n,]+/).map(k => k.trim()).filter(Boolean);
          const keywordCount = keywords.length;
          const countDisplayElement = document.getElementById('keywordCountDisplay');

          if (keywordCount == 0) {
            countDisplayElement.textContent = 'Keywords';
          } else {
            countDisplayElement.textContent = `Keyword Count: ${keywordCount}`;
          }
        }

        function sortTable(tableId, columnIndex, isNumeric = false) {
          const table = document.getElementById(tableId);
          const tbody = table.querySelector('tbody');
          const rows = Array.from(tbody.querySelectorAll('tr'));

          // Get the current sort direction from the table's dataset
          const currentSortDirection = table.dataset.sortDirection === 'asc' ? 'asc' : 'desc';

          const comparer = (row1, row2) => {
            const cell1 = row1.querySelectorAll('td')[columnIndex].textContent.trim();
            const cell2 = row2.querySelectorAll('td')[columnIndex].textContent.trim();

            let comparison = 0; // Default comparison value

            if (isNumeric) {
              const num1 = parseFloat(cell1);
              const num2 = parseFloat(cell2);

              if (isNaN(num1) && isNaN(num2)) comparison = 0;
              else if (isNaN(num1)) comparison = 1;
              else if (isNaN(num2)) comparison = -1;
              else comparison = num1 - num2;
            } else {
              comparison = cell1.localeCompare(cell2);
            }

            // Reverse the comparison based on the current sort direction
            return currentSortDirection === 'asc' ? comparison : -comparison;
          };

          rows.sort(comparer);

          // Remove existing rows from the table
          while (tbody.firstChild) {
            tbody.removeChild(tbody.firstChild);
          }

          // Append sorted rows to the table
          rows.forEach(row => tbody.appendChild(row));

          // Update the sort direction for the next click
          table.dataset.sortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
        }


        function makeTableSortable(tableId) {
          const table = document.getElementById(tableId);
          const thead = table.querySelector('thead');
          const headers = thead.querySelectorAll('th');

          headers.forEach((header, columnIndex) => {
            const isNumericColumn = (header.textContent.toLowerCase().includes("search vol") || header.textContent.toLowerCase().includes("cpc") || header.textContent.toLowerCase().includes("rank"));

            header.addEventListener('click', () => {
              sortTable(tableId, columnIndex, isNumericColumn);
            });
            header.style.cursor = 'pointer';
          });

          // Initialize sort direction for the table (ascending by default)
          table.dataset.sortDirection = 'asc';
        }

        function attachKeywordTableListeners(tableId) {
          const table = document.getElementById(tableId);
          if (!table) {
            console.warn(`Table with ID "${tableId}" not found.`);
            return;
          }

          const tableBody = table.querySelector('tbody');
          if (!tableBody) {
            console.warn(`Table with ID "${tableId}" has no tbody.`);
            return;
          }

          tableBody.addEventListener('click', function (event) {
            // Find the closest row element (<tr>) to the clicked element
            const targetRow = event.target.closest('tr');

            if (targetRow) {
              // Get the keyword from the first cell (<td>) of the row
              const keywordCell = targetRow.querySelector('td:first-child');

              if (keywordCell) {
                const keyword = keywordCell.textContent;
                console.log(`Clicked keyword: ${keyword}`); // For debugging
                showSerps(keyword); // Call your showSerps function
              }
            }
          });
        }

        function addTableEventListeners() {
          const rakedKeywordsTable = document.getElementById('rankingKeywordsTable');
          const similarKeywordsTable = document.getElementById('similarKeywordsTable');
          const webpageKeywordsTable = document.getElementById('webpageKeywordsTable');

          if (rakedKeywordsTable) {
            rakedKeywordsTable.addEventListener('click', function (event) {
              if (event.target.tagName === 'TD') {
                const keyword = event.target.parentElement.cells[0].textContent;
                serpModal(keyword);
              }
            });
          }

          if (similarKeywordsTable) {
            similarKeywordsTable.addEventListener('click', function (event) {
              if (event.target.tagName === 'TD') {
                const keyword = event.target.parentElement.cells[0].textContent;
                serpModal(keyword);
              }
            });
          }

          if (webpageKeywordsTable) {
            webpageKeywordsTable.addEventListener('click', function (event) {
              if (event.target.tagName === 'TD') {
                const keyword = event.target.parentElement.cells[0].textContent;
                serpModal(keyword);
              }
            });
          }
        }

      </script>

      <style>
        .rotate {
          animation: rotate-clockwise-animation 2s linear infinite;
          display: inline-block;
          /* Important for transform to work */
        }

        @keyframes rotate-clockwise-animation {
          0% {
            transform: rotate(0deg);
          }

          100% {
            transform: rotate(360deg);
          }
        }
      </style>

      <div class="container">
        <div class="page-inner">
          <div class="page-header">
            <h3 class="fw-bold mb-3">Keyword Analysis</h3>
          </div>
          <div class="row">
            <div class="col">
              <div class="card">
                <div class="card-header">
                  <div class="card-title">Client Information</div>
                </div>
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-6">
                      <div id="keywordAnalysisUrlDiv" class="form-group">
                        <label for="text">URL</label>
                        <input type="text" class="form-control" id="keyword_analysis_url" placeholder="Enter URL" />
                        <small id="keywordAnalysisUrlHelp" class="form-text text-muted" style="display:none;">Either key
                          in a URL / domain and/or keywords to proceed.</small>
                      </div>
                      <div class="form-group">
                        <label class="form-label">Analysis Type</label>
                        <div class="selectgroup w-100">
                          <label class="selectgroup-item">
                            <input type="radio" name="keywordAnalysisType" value="domain" class="selectgroup-input"
                              id="keywordAnalysisTypeDomain" checked />
                            <span class="selectgroup-button">Domain</span>
                          </label>
                          <label class="selectgroup-item">
                            <input type="radio" name="keywordAnalysisType" value="webpage" class="selectgroup-input"
                              id="keywordAnalysisTypeWebpage" />
                            <span class="selectgroup-button">Webpage</span>
                          </label>
                        </div>
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group">
                              <label for="keywordAnalysisCountry">Country</label>
                              <select class="form-select form-control-sm" id="keywordAnalysisCountry">
                                <option value="Singapore">Singapore</option>
                                <option value="None">Global</option>
                                <option value="Australia">Australia</option>
                                <option value="Bhutan">Bhutan</option>
                                <option value="Brazil">Brazil</option>
                                <option value="Canada">Canada</option>
                              </select>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group">
                              <label for="keywordAnalysisLanguage">Language</label>
                              <select class="form-select form-control-sm" id="keywordAnalysisLanguage">
                                <option value="English">English</option>
                                <option value="Arabic">Arabic</option>
                                <option value="Chinese (Simplified)">Chinese (Simplified)</option>
                                <option value="Chinese (Traditional)">Chinese (Traditional)</option>
                              </select>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group" id="keywordAnalysisKeywordsDiv">
                        <label for="comment" id="keywordCountDisplay">Keywords</label>
                        <textarea class="form-control" id="keyword_analysis_keywords" rows="5"></textarea>
                        <small id="keywordAnalysisKeywordsHelp" class="form-text text-muted"
                          style="display:none;">Either key in keywords and/or URL to proceed.</small>
                      </div>
                    </div>
                  </div>
                  <div class="card-action">
                    <button class="btn btn-success" id="keywordAnalysisSubmit"
                      onclick="keywordAnalysis()">Submit</button>
                    <button class="btn btn-danger" onclick="clearKeywordAnalysis()">Clear</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="card" id="rankedKeywordsCard" style="display:none;">
                <div class="card-header">
                  <h4 class="card-title" id="rankingKeywordsHeader">Ranked Keywords</h4>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table id="rankingKeywordsTable" class="display table table-striped table-hover">
                      <thead>
                        <tr>
                          <th>Keyword</th>
                          <th>Search Vol</th>
                          <th>Rank</th>
                          <th>CPC</th>
                          <th>Add</th> <!-- Empty header for the plus icon column -->
                        </tr>
                      </thead>
                      <tbody>

                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card" id="serpCard" style="display:none;">
                <div class="card-header">
                  <h4 id="serpHeader" class="card-title">SERP</h4>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table id="serpTable" class="display table table-striped table-hover">
                      <thead>
                        <tr>
                          <th>Rank</th>
                          <th style="width: 15px;">URL</th>
                          <th>Title</th>
                          <th>Description</th>
                          <th>DA</th>
                        </tr>
                      </thead>
                      <tbody>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="card" id="similarKeywordsCard" style="display:none;">
                <div class="card-header">
                  <h4 class="card-title" id="similarKeywordsHeader">Similar Keywords</h4>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table id="similarKeywordsTable" class="display table table-striped table-hover">
                      <thead>
                        <tr>
                          <th>Keyword</th>
                          <th>Search Vol</th>
                          <th>Difficulty</th>
                          <th>CPC</th>
                          <th>Add</th> <!-- Empty header for the plus icon column -->
                        </tr>
                      </thead>
                      <tbody>

                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card" id="webpageKeywordsCard" style="display:none;">
                <div class="card-header">
                  <h4 class="card-title" id="webpageKeywordsHeader">Keywords Based on Webpage</h4>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table id="webpageKeywordsTable" class="display table table-striped table-hover">
                      <thead>
                        <tr>
                          <th>Keyword</th>
                          <th>Search Vol</th>
                          <th>Competition</th>
                          <th>Search Intent</th>
                          <th>Reason</th>
                          <th>Add</th>
                        </tr>
                      </thead>
                      <tbody>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <div class="card">
                <div class="card-header text-white">
                  <div class="card-title">Keyword Mapping</div>
                </div>
                <div class="card-body">
                  <div class="d-flex justify-content-start mb-3">
                    <button class="btn btn-success me-2"><i class="fas fa-plus me-1"></i> Add New URL</button>
                    <button class="btn btn-secondary"><i class="fas fa-undo me-1"></i> Undo Delete</button>
                  </div>

                  <div class="d-flex justify-content-around flex-wrap">
                    <div class="card shadow-sm mb-3" style="width: 280px;">
                      <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                          <div class="border rounded p-2 flex-grow-1 me-2 text-truncate" title="/social-media/">
                            /social-media/</div>
                          <button class="btn btn-sm btn-outline-danger"><i class="fas fa-times"></i></button>
                        </div>
                        <div class="form-control form-control-sm mb-3 bg-light text-muted" readonly>social media</div>
                        <button class="btn btn-primary w-100"><i class="fas fa-magic me-1"></i> Page
                          Recommendations</button>
                      </div>
                    </div>

                    <div class="card shadow-sm mb-3" style="width: 280px;">
                      <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                          <div class="border rounded p-2 flex-grow-1 me-2 text-truncate"
                            title="/digital-marketing-services/">/digital-marketing-services/</div>
                          <button class="btn btn-sm btn-outline-danger"><i class="fas fa-times"></i></button>
                        </div>
                        <div class="form-control form-control-sm mb-3 bg-light text-muted" readonly>digital marketing
                        </div>
                        <button class="btn btn-primary w-100"><i class="fas fa-magic me-1"></i> Page
                          Recommendations</button>
                      </div>
                    </div>

                    <div class="card shadow-sm mb-3" style="width: 280px;">
                      <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                          <div class="border rounded p-2 flex-grow-1 me-2 text-truncate" title="/seo-agency/">
                            /seo-agency/</div>
                          <button class="btn btn-sm btn-outline-danger"><i class="fas fa-times"></i></button>
                        </div>
                        <div class="form-control form-control-sm mb-3 bg-light text-muted" readonly>seo marketing</div>
                        <button class="btn btn-primary w-100"><i class="fas fa-magic me-1"></i> Page
                          Recommendations</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="card">
              <div class="card-header">
                <div class="card-title">Recommendations for /social-media/</div>
              </div>
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th>Key</th>
                    <th>Recommended Value</th>
                  </tr>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </div>

        </div>

        <footer class="footer">
          <div class="container-fluid d-flex justify-content-between">
            <nav class="pull-left">
              <ul class="nav">
                <li class="nav-item">
                  <a class="nav-link" href="http://www.themekita.com">
                    ThemeKita
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#"> Help </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#"> Licenses </a>
                </li>
              </ul>
            </nav>
            <div class="copyright">
              2024, made with <i class="fa fa-heart heart text-danger"></i> by
              <a href="http://www.themekita.com">ThemeKita</a>
            </div>
            <div>
              Distributed by
              <a target="_blank" href="https://themewagon.com/">ThemeWagon</a>.
            </div>
          </div>
        </footer>
      </div>
    </div>
    <!--   Core JS Files   -->
    <script src="assets/js/core/jquery-3.7.1.min.js"></script>
    <script src="assets/js/core/popper.min.js"></script>
    <script src="assets/js/core/bootstrap.min.js"></script>

    <!-- jQuery Scrollbar -->
    <script src="assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>

    <!-- Chart JS -->
    <script src="assets/js/plugin/chart.js/chart.min.js"></script>

    <!-- jQuery Sparkline -->
    <script src="assets/js/plugin/jquery.sparkline/jquery.sparkline.min.js"></script>

    <!-- Chart Circle -->
    <script src="assets/js/plugin/chart-circle/circles.min.js"></script>

    <!-- Datatables -->
    <script src="assets/js/plugin/datatables/datatables.min.js"></script>

    <!-- Bootstrap Notify -->
    <script src="assets/js/plugin/bootstrap-notify/bootstrap-notify.min.js"></script>

    <!-- jQuery Vector Maps -->
    <script src="assets/js/plugin/jsvectormap/jsvectormap.min.js"></script>
    <script src="assets/js/plugin/jsvectormap/world.js"></script>

    <!-- Sweet Alert -->
    <script src="assets/js/plugin/sweetalert/sweetalert.min.js"></script>

    <!-- Kaiadmin JS -->
    <script src="assets/js/kaiadmin.min.js"></script>
</body>

</html>